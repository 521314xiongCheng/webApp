(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{"./app/web/page/app/components/clickAvatarActionSheet/index.vue":function(e,t,a){"use strict";a("./node_modules/vant/es/action-sheet/style/index.js");var n=a("./node_modules/vant/es/action-sheet/index.js"),o=a("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),s=a.n(o),r=a("./node_modules/@babel/runtime/regenerator/index.js"),l=a.n(r),i=a("./app/web/page/app/utils/index.js"),c=[{name:"设为关注",prop:"follow"},{name:"个人详情",prop:"profile"},{name:"新人行动",prop:"nbcAction"},{name:"添加笔记",prop:"addNote"},{name:"邀请设置收入目标",prop:"setTarget"},{name:"查看目标评估",prop:"assess"},{name:"拨打电话",prop:"call"}],d={data:function(){return{show:!1,actions:[],safeareainsetBottom:!0,lockScroll:!0}},props:{pageName:{type:String,default:"UnitDetailsPage"},profileClickEventName:{type:String,default:"UnitDetailsClick"},focusEventName:{type:String,default:"UnitDetailsSetFocusClick"},unfocusEventName:{type:String,default:"UnitDetailsUnfocusClick"},setTargetEventName:{type:String,default:"UnitDetailsSetIncomeTargetClick"},callEventName:{type:String,default:"UnitDetailsPhoneCallClick"},cancelEventName:{type:String,default:"UnitDetailsCancelClick"},evaluationEventName:{type:String,default:"OffspringDetailsHeadPortraitTargetEvaluationClick"},accountType:{type:String,default:""},isFullScreen:{type:Boolean,default:!1},selectInfo:{type:String,default:""},info:{type:Object,default:function(){return{}}},targetContactId:null},methods:{onSelect:function(e){console.log(e.prop);var t="UnitDetailsClick";switch(e.prop){case"follow":t=this.info.isFocus?this.unfocusEventName:this.focusEventName;break;case"profile":t=this.profileClickEventName;break;case"setTarget":t=this.setTargetEventName;break;case"call":t=this.callEventName;break;case"assess":t=this.evaluationEventName;break;case"nbcAction":t="nbcAction",this.toActionPlan();break;case"addNote":t="addNote",this.goAddNote()}console.log(this.pageName,t),this.$track({context:this.pageName,behavior:t,item_type:this.pageName,item_id:t}),this.$emit("onSelect",e)},toActionPlan:function(){var e="".concat(window.location.origin,"/nbcActionPlan"),t={opaque:!1,targetContactId:this.info.contactId};this.$go(e,t)},goAddNote:function(){var e=this;return s()(l.a.mark((function t(){var a,n,o,s;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$request.get("".concat(e.$ctx.baseApi,"/notes/check?followContactId=").concat(e.info.contactId,"&contactId=").concat(e.targetContactId));case 2:a=t.sent,n=a.data,o="".concat(window.location.origin,"/note"),s={opaque:!1,targetContactId:e.info.contactId,name:e.info.name,levelCode:e.info.careerLevelCode,followed:e.targetContactId},n.hasNote||(o="".concat(window.location.origin,"/addNote"),s={targetContactId:e.info.contactId,name:e.info.name,opaque:!1,levelCode:e.info.careerLevelCode,from:"addNote_none",followed:e.targetContactId}),console.log("params",s),e.$go(o,s);case 9:case"end":return t.stop()}}),t)})))()},onCancel:function(){this.$track({context:this.pageName,behavior:this.cancelEventName,item_type:this.pageName,item_id:this.cancelEventName})},showActions:function(){var e=this;return s()(l.a.mark((function t(){var a,n,o,s;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log(e.$route.path),!e.isFullScreen){t.next=4;break}return e.$toast("请返回竖屏下操作～"),t.abrupt("return");case 4:return a=e.$ctx.baseApi,t.next=7,e.$request.get("".concat(a,"/goldenweek/newconsultant?contactId=").concat(e.info.contactId));case 7:n=t.sent,o=n.data.isNew,s=Object(i.d)(c),e.info.isFocus?s[0].name="移除关注":s[0].name="设为关注",e.info.setTargetIncomeAmt?s[4].name="邀请修改收入目标":s[4].name="邀请设置收入目标","50"===e.info.careerLevelCode&&s.forEach((function(e,t,a){"follow"===e.prop&&a.splice(t,1)})),"note"==e.selectInfo&&(s.forEach((function(e,t,a){"follow"!==e.prop&&"setTarget"!==e.prop&&"assess"!==e.prop||a.splice(t,1)})),s.splice(1,0,{name:"查看笔记",prop:"goNote"})),e.info.contactId.toString()===e.targetContactId&&s.forEach((function(e,t,a){"follow"!==e.prop&&"setTarget"!==e.prop&&"call"!==e.prop||a.splice(t,1)})),"operation"!==e.accountType||e.$route.path.includes("operation")||(s.forEach((function(e,t,a){"follow"!==e.prop&&"setTarget"!==e.prop&&"nbcAction"!==e.prop||a.splice(t,1)})),Number(e.info.careerLevelCode)<50&&s.forEach((function(e,t,a){"call"===e.prop&&a.splice(t,1)}))),"operation"!==e.accountType&&s.forEach((function(e,t,a){"assess"===e.prop&&a.splice(t,1)})),o||s.forEach((function(e,t,a){"nbcAction"===e.prop&&a.splice(t,1)})),e.actions=s,e.show=!0;case 20:case"end":return t.stop()}}),t)})))()}},components:{"van-action-sheet":n.a}},p=a("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),u=Object(p.a)(d,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("van-action-sheet",{attrs:{actions:e.actions,"cancel-text":"取消","safe-area-inset-bottom":e.safeareainsetBottom,"lock-scroll":e.lockScroll},on:{select:e.onSelect,cancel:e.onCancel},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}})}),[],!1,null,"533543d6",null);t.a=u.exports},"./app/web/page/app/components/commonTable.vue":function(e,t,a){"use strict";var n={name:"table-list",props:{tableData:Object,border:{type:Boolean,default:!0},isFullScreen:{type:Boolean,default:!1},setClassName:Function},data:function(){return{loadingText:"拼命加载中"}},mounted:function(){},methods:{sortChange:function(e){this.$emit("sortChange",e)},headerClick:function(e,t){this.$emit("headerClick",e,t)},rowClickchange:function(e){this.$emit("rowClickchange",e)},cellClick:function(e,t,a,n){this.$emit("cellClick",{row:e,column:t,event:a,cell:n})}}},o=(a("./app/web/page/app/components/commonTable.vue?vue&type=style&index=0&id=797892fe&lang=less&scoped=true&"),a("./node_modules/vue-loader/lib/runtime/componentNormalizer.js")),s=Object(o.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"common-table"},[a("el-table",{ref:"commonTable",attrs:{data:e.tableData.data,stripe:!0,"element-loading-text":e.loadingText,"show-header":e.tableData.showHeader,height:e.tableData.height,"header-cell-class-name":"common-table-header","cell-class-name":e.setClassName,border:e.border},on:{"sort-change":e.sortChange,"header-click":e.headerClick,"row-click":e.rowClickchange,"cell-click":e.cellClick}},[e._t("between"),e._v(" "),e._l(e.tableData.header,(function(t){return a("el-table-column",{key:t.prop,attrs:{prop:t.prop,label:t.label,width:t.width,fixed:t.fixed,"min-width":t.minWidth,"max-width":t.maxWidth,sortable:t.sortable,"sort-orders":["descending","ascending",null],align:"center"},scopedSlots:e._u([{key:"default",fn:function(n){return[a("span",[e._v(e._s(t.formatter?t.formatter(n.row,n.$index):n.row[t.prop]))])]}}],null,!0)})})),e._v(" "),e._t("default")],2)],1)}),[],!1,null,"797892fe",null);t.a=s.exports},"./app/web/page/app/components/commonTable.vue?vue&type=style&index=0&id=797892fe&lang=less&scoped=true&":function(e,t,a){"use strict";a("./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js?!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src/index.js?!./node_modules/less-loader/dist/cjs.js?!./node_modules/vue-loader/lib/index.js?!./app/web/page/app/components/commonTable.vue?vue&type=style&index=0&id=797892fe&lang=less&scoped=true&")},"./app/web/page/app/images/icon_input_search.png":function(e,t,a){e.exports=a.p+"img/icon_input_search.8351fb55.png"},"./app/web/page/app/images/nodata.png":function(e,t,a){e.exports=a.p+"img/nodata.ab62307b.png"},"./app/web/page/app/images/search_back.png":function(e,t,a){e.exports=a.p+"img/search_back.40a06b97.png"},"./app/web/page/app/view/note/table_search.vue":function(e,t,a){"use strict";a.r(t);var n=[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("img",{staticClass:"table-empty__bg",attrs:{src:a("./app/web/page/app/images/nodata.png"),alt:""}})])}],o=(a("./node_modules/vant/es/icon/style/index.js"),a("./node_modules/vant/es/icon/index.js")),s=(a("./node_modules/vant/es/button/style/index.js"),a("./node_modules/vant/es/button/index.js")),r=(a("./node_modules/vant/es/search/style/index.js"),a("./node_modules/vant/es/search/index.js")),l=(a("./node_modules/vant/es/list/style/index.js"),a("./node_modules/vant/es/list/index.js")),i=a("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),c=a.n(i),d=a("./node_modules/@babel/runtime/regenerator/index.js"),p=a.n(d),u=a("./app/web/page/app/utils/index.js"),m=a("./app/web/page/app/components/commonTable.vue"),f=a("./app/web/page/app/components/clickAvatarActionSheet/index.vue"),h={data:function(){return{currentData:{},isNoData:!1,loading:!0,finished:!1,tableData:{header:[{label:"最近\n跟进",prop:"followDate",sortable:"custom",formatter:function(e){return e.followDate?e.followDate:"-"}},{label:"事件\n提醒",prop:"remindDate",sortable:"custom",formatter:function(e){return e.remindDate?e.remindDate:"-"}}],data:[]},keyword:"",selectInfo:"note",filter:{pageSize:20,pageNo:1,type:"1",sortEnum:"REMINDDATE",orderEnum:"DESC",search:""},type:"",targetContactId:""}},mounted:function(){this.filter.type=this.$route.query.type,this.targetContactId=this.$route.query.targetContactId,this.type=this.$route.query.type},methods:{goNote:function(){var e="";e="prod"==window.__INITIAL_STATE__.env?"https://intouch-coach-app-stag-latest.prod.pcf.mkc.io/note":"".concat(window.location.origin,"/note");var t={opaque:!1,targetContactId:this.currentData.contactId,levelCode:this.currentData.careerLevelCode,name:this.currentData.name,followed:this.$route.query.targetContactId};this.$go(e,t)},goProflie:function(){var e="";e="prod"==window.__INITIAL_STATE__.env?"https://intouch-coach-app-stag-latest.prod.pcf.mkc.io/profile":"".concat(window.location.origin,"/profile");var t={opaque:!1,targetContactId:this.currentData.contactId,levelCode:this.currentData.careerLevelCode,followed:this.$route.query.targetContactId};this.$go(e,t)},onSelect:function(e){var t=this;return c()(p.a.mark((function a(){return p.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:a.t0=e.prop,a.next="profile"===a.t0?3:"goNote"===a.t0?5:"call"===a.t0?7:9;break;case 3:return t.goProflie(),a.abrupt("break",9);case 5:return t.goNote(),a.abrupt("break",9);case 7:return window.location.href="tel:".concat(t.currentData.mobile),a.abrupt("break",9);case 9:t.$refs.clickAvatarActionSheet.show=!1;case 10:case"end":return a.stop()}}),a)})))()},handleClickAvatar:function(e){var t=this;this.currentData=e,console.log("row",e),this.$nextTick((function(){t.$refs.clickAvatarActionSheet.showActions()}))},handleClickAvatarrec:function(e){var t=this;this.currentData.contactId=e.recruiterContactId,this.currentData.careerLevelCode=e.recruiterLevelCode,this.currentData.mobile=e.recruiterMobile,this.$nextTick((function(){t.$refs.clickAvatarActionSheet.showActions()}))},sortMap:function(e){return{offSpringLineNumber:"OFFSPRINGLINENUMBER",followDate:"FOLLOWDATE",remindDate:"REMINDDATE"}[e]},sortChange:function(e){e.column;var t=e.prop,a=e.order;console.log("调用"),a?("descending"===a?a="desc":"ascending"===a&&(a="asc"),this.filter.sortEnum=this.sortMap(t),this.filter.orderEnum=a.toLocaleUpperCase()):(this.filter.sortEnum=null,this.filter.orderEnum=null),this.tableData.data=[],this.filter.pageNo=1,this.loadData()},onSearch:function(e){this.filter.search=e,this.filter.pageNo=1,this.tableData.data=[],this.loadData()},back:function(){Object(u.b)()},onCancel:function(){Object(u.b)()},callnomarl:function(e,t){window.location.href="tel:".concat(e)},cellClick:function(e){var t={targetContactId:e.row.contactId,linkNote:!0,name:e.row.name,levelCode:e.row.careerLevelCode,opaque:!1,followed:this.$route.query.targetContactId},a="".concat(window.location.origin,"/addNote");"remindDate"==e.column.property&&null!=e.row.remindDate&&""!=e.row.remindDate?(t.noteId=e.row.remindNoteId,this.$go(a,t)):"followDate"==e.column.property&&null!=e.row.followDate&&""!=e.row.followDate&&(t.noteId=e.row.followNoteId,this.$go(a,t))},setClassName:function(e){var t=e.row,a=e.column;if("followDate"==a.property&&""!=t.followDate&&null!=t.followDate||"remindDate"==a.property&&""!=t.remindDate&&null!=t.remindDate)return"date-name"},loadData:function(){var e=this;return c()(p.a.mark((function t(){var a,n,o;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.filter,n=e.$ctx.baseApi,t.next=4,e.$request.get("".concat(n,"/notes/report"),{params:a});case 4:(o=t.sent).data.hasNextPage?e.finished=!1:e.finished=!0,e.tableData.data=o.data.members,e.tableData.data&&e.tableData.data.length?e.isNoData=!1:(e.isNoData=!0,e.keyword=e.filter.search),e.loading=!1;case 9:case"end":return t.stop()}}),t)})))()}},components:{commonTable:m.a,clickAvatarActionSheet:f.a,List:l.a,"van-search":r.a,"van-button":s.a,"van-icon":o.a}},v=(a("./app/web/page/app/view/note/table_search.vue?vue&type=style&index=0&id=7368299e&lang=less&scoped=true&"),a("./node_modules/vue-loader/lib/runtime/componentNormalizer.js")),g=Object(v.a)(h,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"search-wrap"},[n("div",{staticClass:"search-bar"},[n("img",{staticClass:"back_btn",attrs:{src:a("./app/web/page/app/images/search_back.png"),alt:""},on:{click:e.back}}),e._v(" "),n("van-search",{staticClass:"table-search",attrs:{"show-action":"",placeholder:"请输入姓名/直销员编号"},on:{search:e.onSearch,cancel:e.onCancel},scopedSlots:e._u([{key:"left-icon",fn:function(){return[n("img",{staticClass:"icon-input-search",attrs:{src:a("./app/web/page/app/images/icon_input_search.png"),alt:""}})]},proxy:!0}]),model:{value:e.filter.search,callback:function(t){e.$set(e.filter,"search","string"==typeof t?t.trim():t)},expression:"filter.search"}})],1),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.tableData.data.length,expression:"tableData.data.length"}],staticClass:"search-result"},[n("List",{attrs:{finished:e.finished,"finished-text":e.tableData.data&&e.tableData.data.length?"没有更多了":""},on:{load:e.loadData},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},[n("common-table",{ref:"teamTable",attrs:{id:"table-content",border:!1,setClassName:e.setClassName,tableData:e.tableData},on:{sortChange:e.sortChange,cellClick:e.cellClick}},[n("el-table-column",{key:"1",attrs:{label:"顾问\n姓名",fixed:"left",align:"center",width:"70px","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("div",[n("div",{staticClass:"name team_name",on:{click:function(t){return e.handleClickAvatar(a)}}},[e._v("\n                "+e._s(a.name)+"\n              ")]),e._v(" "),n("div",{staticClass:"tags"},[n("span",{staticClass:"level"},[e._v(e._s(a.careerLevelCode))]),e._v(" "),n("span",{staticClass:"status"},[e._v(e._s(a.activityStatusCode))]),e._v(" "),a.contactId==e.targetContactId?n("span",{staticClass:"self"},[e._v("本人")]):e._e()])])]}}])}),e._v(" "),"1"==this.type?n("el-table-column",{key:"2",attrs:{slot:"between",label:"管理区域",prop:"offSpringLineNumber",align:"center","header-align":"center",sortable:"custom","sort-orders":["descending","ascending",null]},slot:"between",scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n            "+e._s(a.offSpringLineNumber)+"\n          ")]}}],null,!1,3776914284)}):e._e(),e._v(" "),"1"==this.type||"2"==this.type?n("el-table-column",{attrs:{label:"辅导\n姓名",align:"center",width:"70px","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[a.recruiterName?n("div",{on:{click:function(t){return e.handleClickAvatarrec(a)}}},[n("div",{staticClass:"name team_name"},[e._v("\n                "+e._s(a.recruiterName)+"\n              ")]),e._v(" "),n("div",{staticClass:"tags"},[n("span",{staticClass:"level"},[e._v(e._s(a.recruiterLevelCode))]),e._v(" "),n("span",{staticClass:"status"},[e._v(e._s(a.recruiterStatusCode))]),e._v(" "),a.contactId==a.recruiterContactId?n("span",{staticClass:"self"},[e._v("本人")]):e._e()])]):n("div",[e._v("-")])]}}],null,!1,529408998)}):e._e()],1)],1)],1),e._v(" "),n("click-avatar-action-sheet",{ref:"clickAvatarActionSheet",attrs:{info:e.currentData,selectInfo:e.selectInfo},on:{onSelect:e.onSelect}}),e._v(" "),e.isNoData?n("div",{staticClass:"no_data"},[e._m(0),e._v("\n    未查询到"),n("span",{staticClass:"is_active"},[e._v("“"+e._s(e.keyword)+"”")]),e._v("的数据\n  ")]):e._e()],1)}),n,!1,null,"7368299e",null);t.default=g.exports},"./app/web/page/app/view/note/table_search.vue?vue&type=style&index=0&id=7368299e&lang=less&scoped=true&":function(e,t,a){"use strict";a("./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js?!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src/index.js?!./node_modules/less-loader/dist/cjs.js?!./node_modules/vue-loader/lib/index.js?!./app/web/page/app/view/note/table_search.vue?vue&type=style&index=0&id=7368299e&lang=less&scoped=true&")},"./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js?!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src/index.js?!./node_modules/less-loader/dist/cjs.js?!./node_modules/vue-loader/lib/index.js?!./app/web/page/app/components/commonTable.vue?vue&type=style&index=0&id=797892fe&lang=less&scoped=true&":function(e,t,a){},"./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js?!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src/index.js?!./node_modules/less-loader/dist/cjs.js?!./node_modules/vue-loader/lib/index.js?!./app/web/page/app/view/note/table_search.vue?vue&type=style&index=0&id=7368299e&lang=less&scoped=true&":function(e,t,a){}}]);