(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{"./app/web/page/app/images/income/link.png":function(e,t,n){e.exports=n.p+"img/link.d532aa3e.png"},"./app/web/page/app/view/income/incomeList.vue":function(e,t,n){"use strict";n.r(t);var a=n("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),o=n.n(a),s=n("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),i=n.n(s),r=(n("./node_modules/vant/es/nav-bar/style/index.js"),n("./node_modules/vant/es/nav-bar/index.js")),c=(n("./node_modules/vant/es/notice-bar/style/index.js"),n("./node_modules/vant/es/notice-bar/index.js")),l=n("./node_modules/@babel/runtime/regenerator/index.js"),d=n.n(l),u=n("./app/web/page/app/utils/index.js"),p=n("./app/web/page/app/utils/customer.js"),m={components:{"van-notice-bar":c.a,NavBar:r.a},data:function(){return{isIos:Object(u.l)(),options:{useEasing:!0,useGrouping:!0,separator:",",decimal:".",prefix:"￥ ",suffix:"",decimalPlaces:2},tableOptions:{useEasing:!0,useGrouping:!0,separator:",",decimal:".",prefix:"",suffix:"",decimalPlaces:2},incomeData:[],impersonatedContactId:"20002868550",monthKey:null}},mounted:function(){var e=this;return i()(d.a.mark((function t(){var n,a,s,i,r;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.$route.query.monthKey,console.log("monthKey",n),e.monthKey=n,a=(a=e.$ctx.baseApiList.income).replace("v1","v2"),t.prev=5,e.impersonatedContactId=e.$ctx.targetContactId,t.next=9,e.$request.get("".concat(a,"/prodIncome/incomeTotal"),{headers:{impersonatedContactId:e.impersonatedContactId}});case 9:s=t.sent,i=s.data.data.sort((function(e,t){return t.monthKey-e.monthKey})),r=o()(new Set(i.map((function(e){return e.monthKey.slice(0,4)})))),e.incomeData=[],r.forEach((function(t){e.incomeData.push({year:t,monthDatas:i.filter((function(e){return e.monthKey.includes(t)}))})})),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(5),console.log(t.t0);case 19:case"end":return t.stop()}}),t,null,[[5,16]])})))()},methods:{back:function(){Object(u.b)()},customer:function(){var e=this;return i()(d.a.mark((function t(){var n,a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(p.a)();case 2:n=t.sent,a="".concat(n,"&title=我的客服"),e.$jsBridge.openSchema(a);case 5:case"end":return t.stop()}}),t)})))()},format_number:function(e){if(null===e)return"-";e=e.toFixed(2);for(var t=(e+="").split("."),n=t[0],a=t.length>1?"."+t[1]:"",o=/(\d+)(\d{3})/;o.test(n);)n=n.replace(o,"$1,$2");return n+a},toDetail:function(e){var t=this;return i()(d.a.mark((function n(){var a,o,s,i,r,c,l;return d.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a="".concat(window.location.origin,"/income"),o={monthKey:e.monthKey,amount:e.amount,opaque:!1,targetContactId:t.impersonatedContactId,hiddenHistoryBtn:!0},s=(new Date).getDate(),i=t.$ctx.baseApiList.income,r={monthKey:e.monthKey},c="".concat(i,"/prodIncome/myIncomes?monthKey=").concat(r.monthKey),l=!1,n.prev=7,n.next=10,t.$request.get(c,{headers:{impersonatedContactId:t.impersonatedContactId}});case 10:n.sent.data.myIncome.incomeList.forEach((function(e){e.total&&0!==e.total&&(l=!0,e.dataList.forEach((function(e){e.value&&0!==e.value&&(l=!0)})))})),n.next=16;break;case 14:n.prev=14,n.t0=n.catch(7);case 16:console.log(l),(1===s&&e.monthKey===t.monthKey||!l)&&(o.day=s,a="".concat(window.location.origin,"/processing")),Object(u.k)(a,o);case 19:case"end":return n.stop()}}),n,null,[[7,14]])})))()}}},f=(n("./app/web/page/app/view/income/incomeList.vue?vue&type=style&index=0&id=0928f2aa&lang=less&scoped=true&"),n("./node_modules/vue-loader/lib/runtime/componentNormalizer.js")),v=Object(f.a)(m,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"my-income",class:{isAndroid:!e.isIos}},[a("NavBar",{attrs:{"left-text":"返回",fixed:"","right-text":"",title:"历史收入",border:!1,"safe-area-inset-top":!0},on:{"click-left":e.back,"click-right":e.customer},scopedSlots:e._u([{key:"left",fn:function(){return[a("img",{staticClass:"back_btn",attrs:{src:n("./app/web/page/app/images/index/icon_back.png"),alt:""}})]},proxy:!0},{key:"right",fn:function(){return[a("img",{staticClass:"customer_btn",attrs:{src:n("./app/web/page/app/images/index/icon_customer.png"),alt:""}})]},proxy:!0}])}),e._v(" "),a("div",{staticClass:"my-income-content"},[a("div",e._l(e.incomeData,(function(t,o){return a("div",{key:"income_"+o,staticClass:"income-data"},[a("div",{staticClass:"income-data-year"},[e._v(e._s(t.year)+"年度")]),e._v(" "),a("el-table",{attrs:{data:t.monthDatas,stripe:"",border:!1},on:{"row-click":e.toDetail}},[a("el-table-column",{attrs:{prop:"monthKey",label:"月份"}}),e._v(" "),a("el-table-column",{attrs:{prop:"amount",label:"收入",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return[a("div",{staticClass:"table-amount"},[e._v("\n                "+e._s(e.format_number(o.amount))+"\n                "),a("img",{attrs:{src:n("./app/web/page/app/images/income/link.png"),alt:""}})])]}}],null,!0)})],1)],1)})),0)])],1)}),[],!1,null,"0928f2aa",null);t.default=v.exports},"./app/web/page/app/view/income/incomeList.vue?vue&type=style&index=0&id=0928f2aa&lang=less&scoped=true&":function(e,t,n){"use strict";n("./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js?!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src/index.js?!./node_modules/less-loader/dist/cjs.js?!./node_modules/vue-loader/lib/index.js?!./app/web/page/app/view/income/incomeList.vue?vue&type=style&index=0&id=0928f2aa&lang=less&scoped=true&")},"./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js?!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src/index.js?!./node_modules/less-loader/dist/cjs.js?!./node_modules/vue-loader/lib/index.js?!./app/web/page/app/view/income/incomeList.vue?vue&type=style&index=0&id=0928f2aa&lang=less&scoped=true&":function(e,t,n){}}]);