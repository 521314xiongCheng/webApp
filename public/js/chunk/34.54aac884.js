(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{"./app/web/page/app/images/choseinfo.png":function(e,t,o){e.exports=o.p+"img/choseinfo.c6949ae3.png"},"./app/web/page/app/images/date.png":function(e,t,o){e.exports=o.p+"img/date.035e6622.png"},"./app/web/page/app/images/info.png":function(e,t,o){e.exports=o.p+"img/info.bd8ae466.png"},"./app/web/page/app/images/loading.gif":function(e,t,o){e.exports=o.p+"img/loading.f82f9309.gif"},"./app/web/page/app/view/note/addNote.vue":function(e,t,o){"use strict";o.r(t);o("./node_modules/vant/es/button/style/index.js");var n=o("./node_modules/vant/es/button/index.js"),a=(o("./node_modules/vant/es/sticky/style/index.js"),o("./node_modules/vant/es/sticky/index.js")),s=(o("./node_modules/vant/es/popup/style/index.js"),o("./node_modules/vant/es/popup/index.js")),d=(o("./node_modules/vant/es/swipe-cell/style/index.js"),o("./node_modules/vant/es/swipe-cell/index.js")),i=(o("./node_modules/vant/es/cell/style/index.js"),o("./node_modules/vant/es/cell/index.js")),l=(o("./node_modules/vant/es/calendar/style/index.js"),o("./node_modules/vant/es/calendar/index.js")),c=(o("./node_modules/vant/es/switch/style/index.js"),o("./node_modules/vant/es/switch/index.js")),r=(o("./node_modules/vant/es/list/style/index.js"),o("./node_modules/vant/es/list/index.js")),u=(o("./node_modules/vant/es/nav-bar/style/index.js"),o("./node_modules/vant/es/nav-bar/index.js")),p=(o("./node_modules/vant/es/dialog/style/index.js"),o("./node_modules/vant/es/dialog/index.js")),g=o("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),h=o.n(g),m=o("./node_modules/@babel/runtime/regenerator/index.js"),v=o.n(m),f=o("./app/web/page/app/utils/index.js"),w=o("./app/web/page/app/mixin/horizontalScreen.js"),x=(o("./node_modules/good-storage/dist/storage.esm.js"),{mixins:[w.a],data:function(){return{isIos:Object(f.l)(),showCalendar:!1,linkNote:!0,auto:!0,choseDate:"",goPush:!1,minDate:new Date(2010,0,1),loadChange:!1,from:"",note:{needPush:!1,noteContent:"",noteDate:"",needPushShow:"",showPush:!1}}},created:function(){this.$route.query.linkNote?this.linkNote=!this.$route.query.linkNote:this.linkNote=!0},mounted:function(){var e=new Date,t=e.getFullYear(),o=e.getMonth()+1>=10?e.getMonth()+1:"0"+(e.getMonth()+1),n=e.getDate()>=10?e.getDate():"0"+e.getDate();this.note.noteDate="".concat(t,"-").concat(o,"-").concat(n),this.choseDate="".concat(t).concat(o).concat(n),this.$route.query.noteId?(this.getNoteInfo(),this.auto=!1):this.auto=!0,console.log("auto",this.auto)},methods:{goshowCalendar:function(){this.linkNote?this.showCalendar=!0:this.showCalendar=!1},getNoteInfo:function(){var e=this;return h()(v.a.mark((function t(){var o,n,a,s,d,i;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=e.$route.query.followed){t.next=8;break}return t.next=4,e.$jsBridge.getUserProfile();case 4:n="string"==typeof(n=t.sent)?JSON.parse(n):n,console.log(n),o=n.contact_id;case 8:return a={contactId:o},console.log("查看"),s=e.$ctx.baseApi,t.next=13,e.$request.get("".concat(s,"/notes/").concat(e.$route.query.noteId),{params:a});case 13:d=t.sent,(i=d.data)||p.a.alert({message:"当前事件已被删除，请知晓。"}).then((function(){var t={opaque:!1,noteId:e.$route.query.noteId,targetContactId:e.$route.query.targetContactId,name:e.$route.query.name,levelCode:e.$route.query.levelCode,from:e.from,followed:o},n="".concat(window.location.origin,"/note");e.$go(n,t)})),e.note=i,e.note.showPush=i.needPush,2==i.labelType&&(e.note.showPush=!0),console.log("data",i);case 20:case"end":return t.stop()}}),t)})))()},gopush:function(){var e=this;return h()(v.a.mark((function t(){var o,n,a,s,d,i;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.note.noteContent){t.next=23;break}if(!e.$route.query.noteId){t.next=10;break}return o=e.$ctx.baseApi,n=e.$route.query.noteId,t.next=6,e.$request.put("".concat(o,"/notes/").concat(n,"?updateType=1&followContactId=").concat(e.$route.query.targetContactId,"&noteDate=").concat(e.note.noteDate,"&noteContent=").concat(e.note.noteContent,"&needPush=").concat(e.note.needPush,"&contactId=").concat(e.$route.query.followed));case 6:t.sent&&(e.loadChange=!0),t.next=19;break;case 10:return a=e.$ctx.baseApi,(s=e.note).followContactId=Number(e.$route.query.targetContactId),console.log("params",s),t.next=16,e.$request.post("".concat(a,"/notes?followContactId=").concat(e.$route.query.targetContactId,"&noteDate=").concat(e.note.noteDate,"&noteContent=").concat(e.note.noteContent,"&needPush=").concat(e.note.needPush,"&contactId=").concat(e.$route.query.followed),s);case 16:d=t.sent,console.log("res",d),d&&(e.loadChange=!0);case 19:e.linkNote=!1,"".concat(window.location.origin,"/note"),i={targetContactId:e.$route.query.targetContactId,name:e.$route.query.name,levelCode:e.$route.query.levelCode,opaque:!1,followed:e.$route.query.followed,fullscreen:!0},"addNote_none"==e.$route.query.from?e.$router.replace({name:"note",query:i}):Object(f.b)();case 23:case"end":return t.stop()}}),t)})))()},back:function(){Object(f.b)()},formatDate:function(e){var t=e.getMonth()+1>=10?e.getMonth()+1:"0"+(e.getMonth()+1),o=e.getDate()>=10?e.getDate():"0"+e.getDate();return"".concat(e.getFullYear()).concat(t).concat(o)>this.choseDate?(this.note.showPush=!0,this.note.needPush=!0):(this.note.showPush=!1,this.note.needPush=!1),"".concat(e.getFullYear(),"-").concat(t,"-").concat(o)},onConfirm:function(e){console.log("date",e),this.showCalendar=!1,this.note.noteDate=this.formatDate(e),console.log(" this.choseDate",this.choseDate)}},watch:{note:{handler:function(e,t){""!=e.noteContent?this.goPush=!0:this.goPush=!1},deep:!0}},components:{NavBar:u.a,List:r.a,"van-switch":c.a,"van-calendar":l.a,"van-cell":i.a,"van-swipe-cell":d.a,"van-popup":s.a,"van-sticky":a.a,"van-button":n.a}}),b=(o("./app/web/page/app/view/note/addNote.vue?vue&type=style&index=0&id=5d9e4b98&lang=less&scoped=true&"),o("./node_modules/vue-loader/lib/runtime/componentNormalizer.js")),_=Object(b.a)(x,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"coach-home",class:{isAndroid:!e.isIos}},[n("div",{staticClass:"coach-home-content"},[n("van-sticky",[n("NavBar",{attrs:{"left-text":"返回",title:"内容",border:!1,"safe-area-inset-top":!0},on:{"click-left":e.back},scopedSlots:e._u([{key:"left",fn:function(){return[n("img",{staticClass:"back_btn",attrs:{src:o("./app/web/page/app/images/index/icon_back.png"),alt:""}})]},proxy:!0},this.linkNote?{key:"right",fn:function(){return[n("span",{class:{goPush:e.goPush},on:{click:function(t){return e.gopush()}}},[e._v("保存")])]},proxy:!0}:null],null,!0)})],1),e._v(" "),n("div",{staticClass:"note"},[n("p",{staticClass:"note-date",on:{click:function(t){return e.goshowCalendar()}}},[n("img",{attrs:{src:o("./app/web/page/app/images/date.png"),alt:""}}),e._v("\n        "+e._s(this.note.noteDate)+"\n      ")]),e._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.note.noteContent,expression:"note.noteContent"}],ref:"textarea",staticClass:"note-input",attrs:{maxlength:"256",disabled:!this.linkNote,placeholder:"请输入需要备注的内容～",id:"noteinput"},domProps:{value:e.note.noteContent},on:{input:function(t){t.target.composing||e.$set(e.note,"noteContent",t.target.value)}}})]),e._v(" "),this.note.showPush?n("div",{staticClass:"infopush"},[n("div",{staticClass:"push-text",class:{pushActive:e.note.needPush}},[e.note.needPush?n("img",{attrs:{src:o("./app/web/page/app/images/choseinfo.png"),alt:""}}):n("img",{attrs:{src:o("./app/web/page/app/images/info.png"),alt:""}}),e._v(" "),n("span",[e._v("需要推送提醒吗")])]),e._v(" "),n("div",[n("van-switch",{attrs:{disabled:!this.linkNote,"active-color":"#F16EAE","inactive-color":"#dcdee0",size:"24px"},model:{value:e.note.needPush,callback:function(t){e.$set(e.note,"needPush",t)},expression:"note.needPush"}})],1)]):e._e(),e._v(" "),this.loadChange?n("div",{staticClass:"loading"},[n("img",{attrs:{src:o("./app/web/page/app/images/loading.gif"),alt:""}})]):e._e()],1),e._v(" "),n("van-calendar",{attrs:{"min-date":e.minDate,color:"#F16EAE"},on:{confirm:e.onConfirm},model:{value:e.showCalendar,callback:function(t){e.showCalendar=t},expression:"showCalendar"}})],1)}),[],!1,null,"5d9e4b98",null);t.default=_.exports},"./app/web/page/app/view/note/addNote.vue?vue&type=style&index=0&id=5d9e4b98&lang=less&scoped=true&":function(e,t,o){"use strict";o("./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js?!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src/index.js?!./node_modules/less-loader/dist/cjs.js?!./node_modules/vue-loader/lib/index.js?!./app/web/page/app/view/note/addNote.vue?vue&type=style&index=0&id=5d9e4b98&lang=less&scoped=true&")},"./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js?!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src/index.js?!./node_modules/less-loader/dist/cjs.js?!./node_modules/vue-loader/lib/index.js?!./app/web/page/app/view/note/addNote.vue?vue&type=style&index=0&id=5d9e4b98&lang=less&scoped=true&":function(e,t,o){}}]);