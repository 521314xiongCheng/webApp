(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{"./app/web/page/app/images/icon_input_search.png":function(e,t,s){e.exports=s.p+"img/icon_input_search.8351fb55.png"},"./app/web/page/app/images/nodata.png":function(e,t,s){e.exports=s.p+"img/nodata.ab62307b.png"},"./app/web/page/app/view/home/employee.vue":function(e,t,s){"use strict";s.r(t);var a=[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("img",{staticClass:"table-empty__bg",attrs:{src:s("./app/web/page/app/images/nodata.png"),alt:""}})])}],n=s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),o=s.n(n),i=(s("./node_modules/vant/es/skeleton/style/index.js"),s("./node_modules/vant/es/skeleton/index.js")),r=(s("./node_modules/vant/es/image/style/index.js"),s("./node_modules/vant/es/image/index.js")),l=(s("./node_modules/vant/es/search/style/index.js"),s("./node_modules/vant/es/search/index.js")),c=(s("./node_modules/vant/es/list/style/index.js"),s("./node_modules/vant/es/list/index.js")),d=(s("./node_modules/vant/es/nav-bar/style/index.js"),s("./node_modules/vant/es/nav-bar/index.js")),p=s("./node_modules/@babel/runtime/regenerator/index.js"),u=s.n(p),m=s("./app/web/page/app/utils/index.js"),v=s("./node_modules/good-storage/dist/storage.esm.js"),g={data:function(){return{isIos:Object(m.l)(),members:[],employeeList:[],consultantList:[],filter:{pageNo:1,pageSize:20,searchStr:""},finished:!1,loading:!0,monthKey:null,searchStr:"",isNoData:!1,isEmployee:!1}},components:{NavBar:d.a,List:c.a,"van-search":l.a,"van-image":r.a,"van-skeleton":i.a},created:function(){var e=this;return o()(u.a.mark((function t(){var s,a,n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=e.$ctx.baseApi,t.next=3,e.$request.get("".concat(s,"/monthkey"));case 3:a=t.sent,n=a.data,e.monthKey=n,e.initPage();case 7:case"end":return t.stop()}}),t)})))()},methods:{back:function(){Object(m.b)()},initPage:function(){var e=this;return o()(u.a.mark((function t(){var s,a,n,o,i;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=e.$ctx.baseApi,t.prev=1,t.next=4,e.$request.get("".concat(s,"/employees/role"));case 4:a=t.sent,n=a.data,console.log("employees/role",n),o=n.isAdmin,i=n.isEmployee,e.isEmployee=i,o?e.getEmployeeAccounts():i?e.$router.push({path:"/operation",query:{monthKey:e.monthKey}}):(e.loading=!1,e.$toast({message:"您没有查看权限!",duration:0})),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1),e.getEmployeeAccounts();case 15:case"end":return t.stop()}}),t,null,[[1,12]])})))()},getEmployeeAccounts:function(){var e=this;return o()(u.a.mark((function t(){var s,a,n,o;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=e.$ctx.baseApi,a=e.filter,t.next=4,e.$request.get("".concat(s,"/employees/accounts"),{params:a});case 4:n=t.sent,o=n.data,console.log("employees/role",o),e.loading=!1,e.employeeList=o.employeeList,e.consultantList=o.consultantInfo.consultantList,e.employeeList.length||e.consultantList.length?e.isNoData=!1:(e.searchStr=e.filter.searchStr,e.isNoData=!0);case 11:case"end":return t.stop()}}),t)})))()},loadData:function(){var e=this;return o()(u.a.mark((function t(){var s,a,n,o;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=e.$ctx.baseApi,a=e.filter,t.next=4,e.$request.get("".concat(s,"/employees/accounts"),{params:a});case 4:n=t.sent,o=n.data,e.total=o.total,e.loading=!1,o.consultantInfo.hasNextPage?e.finished=!1:e.finished=!0,e.consultantList=e.consultantList.concat(o.consultantInfo.consultantList),e.filter.pageNo=e.filter.pageNo+1;case 11:case"end":return t.stop()}}),t)})))()},onSearch:function(){var e=this;return o()(u.a.mark((function t(){var s,a,n,o;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.$jsBridge.startBusy(),e.filter.pageNo=1,e.employeeList=[],e.consultantList=[],s=e.$ctx.baseApi,a=e.filter,t.next=8,e.$request.get("".concat(s,"/employees/accounts"),{params:a});case 8:n=t.sent,o=n.data,console.log("employees/role",o),e.$jsBridge.stopBusy(),e.loading=!1,o.consultantInfo.hasNextPage?e.finished=!1:e.finished=!0,e.employeeList=o.employeeList,e.consultantList=o.consultantInfo.consultantList,e.filter.pageNo=e.filter.pageNo+1,e.employeeList.length||e.consultantList.length?e.isNoData=!1:(e.searchStr=e.filter.searchStr,e.isNoData=!0);case 18:case"end":return t.stop()}}),t)})))()},toNextPage:function(e,t,s){v.a.set("ContactId",e.contactId);var a="".concat(window.location.origin,"/home"),n={opaque:!1,levelCode:e.careerLevelCode,targetContactId:e.contactId,ImpersonatedContactID:e.contactId,monthKey:this.monthKey,isEmployee:!1,loginName:s};"employee"===t&&(n.consultantName="".concat(e.consultantLastName).concat(e.consultantFirstName),n.isEmployee=!0,a="".concat(window.location.origin,"/operation")),this.$go(a,n)}}},_=(s("./app/web/page/app/view/home/employee.vue?vue&type=style&index=0&id=40e6b20e&lang=less&scoped=true&"),s("./node_modules/vue-loader/lib/runtime/componentNormalizer.js")),h=Object(_.a)(g,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-wrap",class:{isAndroid:!e.isIos}},[a("NavBar",{attrs:{"left-text":"返回",fixed:"",title:"我的教练业务查询",border:!1,"safe-area-inset-top":!0},on:{"click-left":e.back},scopedSlots:e._u([{key:"left",fn:function(){return[a("img",{staticClass:"back_btn",attrs:{src:s("./app/web/page/app/images/index/icon_back.png"),alt:""}})]},proxy:!0}])}),e._v(" "),a("div",{staticClass:"page-wrap-content"},[a("van-search",{staticClass:"table-search",attrs:{placeholder:"请输入姓名/12位编号搜索"},on:{search:e.onSearch},scopedSlots:e._u([{key:"left-icon",fn:function(){return[a("img",{staticClass:"icon-input-search",attrs:{src:s("./app/web/page/app/images/icon_input_search.png"),alt:""}})]},proxy:!0}]),model:{value:e.filter.searchStr,callback:function(t){e.$set(e.filter,"searchStr",t)},expression:"filter.searchStr"}}),e._v(" "),a("van-skeleton",{attrs:{title:"",row:3,loading:e.loading&&!e.employeeList.length&&!e.consultantList.length}},[a("div"),e._v(" "),e.employeeList.length?a("div",{staticClass:"members"},[a("div",{staticClass:"members-group-title"},[e._v("员工账号名单")]),e._v(" "),e._l(e.employeeList,(function(t,s){return a("div",{key:"member_"+s,staticClass:"members-item",on:{click:function(s){return e.toNextPage(t,"employee",""+t.consultantLastName+t.consultantFirstName)}}},[a("van-image",{staticClass:"avatar",attrs:{fit:"cover",src:"https://consultant-ecard-api-external-latest.prod.pcf.mkc.io/v1/user/"+t.contactId+"/avatar?size=60"}}),e._v(" "),a("div",{staticClass:"members-item-right"},[a("div",[a("span",{staticClass:"name"},[e._v(e._s(t.consultantLastName)+e._s(t.consultantFirstName))]),e._v(" "),a("span",{staticClass:"level"},[e._v(e._s(t.careerLevelCode))])]),e._v(" "),a("span",{staticClass:"area"},[e._v(e._s(t.nsdName))])])],1)}))],2):e._e(),e._v(" "),a("List",{attrs:{finished:e.finished,"finished-text":e.consultantList&&e.consultantList.length?"没有更多了":""},on:{load:e.loadData},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},[e.consultantList.length?a("div",{staticClass:"members"},[a("div",{staticClass:"members-group-title"},[e._v("顾问名单")]),e._v(" "),e._l(e.consultantList,(function(t,s){return a("div",{key:"member_"+s,staticClass:"members-item",on:{click:function(s){return e.toNextPage(t,"consultant",""+t.consultantLastName+t.consultantFirstName)}}},[a("van-image",{staticClass:"avatar",attrs:{fit:"cover",src:"https://consultant-ecard-api-external-latest.prod.pcf.mkc.io/v1/user/"+t.contactId+"/avatar?size=60"}}),e._v(" "),a("div",{staticClass:"members-item-right"},[a("div",[a("span",{staticClass:"name"},[e._v(e._s(t.consultantLastName)+e._s(t.consultantFirstName))]),e._v(" "),a("span",{staticClass:"level"},[e._v(e._s(t.careerLevelCode))])]),e._v(" "),a("span",{staticClass:"area"},[e._v(e._s(t.nsdName))])])],1)}))],2):e._e()])],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isNoData,expression:"isNoData"}],staticClass:"no_data"},[e._m(0),e._v("\n      未查询到"),a("span",{staticClass:"is_active"},[e._v("“"+e._s(e.searchStr)+"”")]),e._v("的数据\n    ")])],1)],1)}),a,!1,null,"40e6b20e",null);t.default=h.exports},"./app/web/page/app/view/home/employee.vue?vue&type=style&index=0&id=40e6b20e&lang=less&scoped=true&":function(e,t,s){"use strict";s("./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js?!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src/index.js?!./node_modules/less-loader/dist/cjs.js?!./node_modules/vue-loader/lib/index.js?!./app/web/page/app/view/home/employee.vue?vue&type=style&index=0&id=40e6b20e&lang=less&scoped=true&")},"./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js?!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src/index.js?!./node_modules/less-loader/dist/cjs.js?!./node_modules/vue-loader/lib/index.js?!./app/web/page/app/view/home/employee.vue?vue&type=style&index=0&id=40e6b20e&lang=less&scoped=true&":function(e,t,s){}}]);